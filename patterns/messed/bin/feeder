#!/usr/bin/env ruby

require 'rubygems'
begin
  require 'messed'
rescue LoadError
  if ENV['MESSED_HOME']
    require File.join(ENV['MESSED_HOME'], 'lib', 'messed')
  else  
    raise("no messed!")
  end
end

require 'thor'

class Feeder < Thor

  desc "start a feeder [NAME]", "start a feed instance"
  def start(name = nil)
    application = Messed::Application.new(File.expand_path(File.join(File.dirname(__FILE__), '..')))
    feeder = if name.nil? and application.feeders.size == 0
      application.feeders.values.first
    elsif @application.feeders.key?(name)
      application.feeders[name]
    else
      raise "unable to find feeder"
    end
    
    feeder.start
  end
  
end

Feeder.start